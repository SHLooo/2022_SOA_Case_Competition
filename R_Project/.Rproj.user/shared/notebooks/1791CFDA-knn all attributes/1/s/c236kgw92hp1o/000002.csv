"0","#set.seed(123)"
"0","#Generate a random number that is 90% of the total number of rows in dataset."
"0","ran <- sample(1:nrow(Tourn.JoinedTable.ranked), 0.9 * nrow(Tourn.JoinedTable.ranked))"
"0",""
"0","#the normalization function is created"
"0","norm <-function(x) { (x-min(x))/(max(x)-min(x)) }"
"0",""
"0","playerIndex <- which(colnames(Tourn.JoinedTable.ranked) == ""Player"")"
"0","rankIndex <- which(colnames(Tourn.JoinedTable.ranked) == ""nation rank"")"
"0","Tourn_norm <- as.data.frame(lapply(Tourn.JoinedTable.ranked[,-c(playerIndex,rankIndex)], norm))"
"0",""
"0","Tourn_train <- Tourn_norm[ran,] "
"0","Tourn_test <- Tourn_norm[-ran,] "
"0",""
"0","Tourn_target_category <- as.data.frame(Tourn.JoinedTable.ranked)[ran,rankIndex]"
"0","Tourn_test_category <- as.data.frame(Tourn.JoinedTable.ranked)[-ran,rankIndex]"
"0",""
"0","library(class)"
"0","#run knn function"
"0","k <- 12"
"0","error <- 9"
"0","pr <- knn(Tourn_train,Tourn_test,cl=Tourn_target_category,k=k,use.all = TRUE)"
"0","accuracy <- sum(abs(as.numeric(pr) - as.numeric(Tourn_test_category)) <= error) / length(pr)"
"0","accuracy"
"1","[1]"
"1"," 0.787234"
"1","
"

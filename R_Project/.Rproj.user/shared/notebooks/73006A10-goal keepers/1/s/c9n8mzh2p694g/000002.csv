"0","set.seed(123456)"
"0","#Generate a random number that is 90% of the total number of rows in dataset."
"0","ran <- sample(1:nrow(TournGoalkeeping.groupByPlayer), 0.9 * nrow(TournGoalkeeping.groupByPlayer))"
"0",""
"0","#the normalization function is created"
"0","nor <-function(x) { (x-min(x))/(max(x)-min(x)) }"
"0",""
"0","ni <- ncol(TournGoalkeeping.groupByPlayer)"
"0","Tourn_norm <- as.data.frame(lapply(TournGoalkeeping.groupByPlayer[,-c(1,ni)], nor))"
"0",""
"0","Tourn_train <- Tourn_norm[ran,] "
"0","Tourn_test <- Tourn_norm[-ran,] "
"0",""
"0","Tourn_target_category <- as.data.frame(TournGoalkeeping.groupByPlayer)[ran,ni]"
"0","Tourn_test_category <- as.data.frame(TournGoalkeeping.groupByPlayer)[-ran,ni]"
"0",""
"0","library(class)"
"0","pr <- knn(Tourn_train,Tourn_test,cl=Tourn_target_category,k=1,use.all = TRUE)"
"0","allowed.rank.error <- 3"
"0","accuracy <- sum(abs(as.numeric(pr) - as.numeric(Tourn_test_category)) <= allowed.rank.error) / length(pr)"
"0","accuracy"
"1","[1]"
"1"," 0.4"
"1","
"
